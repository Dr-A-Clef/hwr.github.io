"use strict";function visible(t){return t.length&&!t.is(":hidden")}function dateDiffInDays(t,e){var i=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return Math.floor((n-i)/864e5)}function initAndUpdate(t){$(window).on("load",t).resize(t)}function scrollSpy(t,e){var i=$(t);if(!visible(i))return;e=e||{};var n=e.offset||0;var a=e.activeClassName||"active";var r=i.find("a").map(function(){var t=$($(this).attr("href"));if(t.length)return t[0]}),o=null,s=$();$(window).scroll(function(){var t=$(this).scrollTop()+n;var e=r.filter(function(){return $(this).offset().top<t}).last().attr("id")||"";if(o!==e){s.removeClass(a);var l=[];for(var c=i.find("[href='#"+e+"']");c.length&&!c.is(i);c=c.parent()){if(c.is("li"))l.push(c[0])}s=$(l).addClass(a).trigger("scrollspy");o=e}})}function makeSticky(t,e){var i=$(t);if(!visible(i))return;e=e||{};var n=$(e.below||"#header").height(),a=$(e.within||"#primary"),r=i.position().top,o=0;initAndUpdate(function(){var t=a.position().top+a.outerHeight();o=t-i.height()});$(window).scroll(function(){var t=$(window).scrollTop(),e;if(t<n)e=r-t;else if(o>t)e=r-n;else e=o-t;i.css("top",e)})}function template(t,e){var i=$(t).html().split(/\{\{([^\}]+)\}\}/g);return e.map(function(t){return i.map(function(e,i){return i%2?t[e]:e}).join("")})}$(function(){$("#sidebar").load("/parts/sidebar.html",function(){var t=$(this).find("#recent-posts .list").attr("data-suffix");$(this).find(".update-time").each(function(){var e=new Date($(this).attr("data-date")),i=dateDiffInDays(e,new Date);if(100>=i)$(this).html(i.toString()+t)});var e=$(".dq-recent-comments");if(!visible(e))return;$.get({url:"https://disqus.com/api/3.0/forums/listPosts.jsonp",data:$.param({api_key:CONFIG.disqus.api_key,forum:CONFIG.disqus.forum,limit:e.attr("data-num-items"),related:"thread"}),dataType:"jsonp",contentType:"text/javascript; charset=utf-8"}).then(function(t){e.append(template("#dq-recent-comments-template",$.map(t.response,function(t){var e=t.message.length>20?t.message.substring(0,18)+"...":t.message;return{comment:e.replace(/<\/?p>/gi,""),link:t.thread.link,title:t.thread.title,profileUrl:t.author.profileUrl,name:t.author.name,createdAt:t.createdAt}})))})})});$(function(){var t,e=false;$("#dropdown").hover(function(){var i=$(this);if(t){clearTimeout(t);t=null}if(!i.hasClass("active")){i.addClass("active");e=true}},function(){var i=$(this);if(i.hasClass("active")&&e){t=setTimeout(function(){i.removeClass("active");e=false;clearTimeout(t);t=null},100)}});$("#global-nav").click(function(){if($(window).width()<768){$(this).toggleClass("collapse")}})});$(function(){var t=$("#totop"),e=$("#totop-canvas"),i=$("#totop-percent"),n=e.width(),a=e.height(),r=n/2,o=parseInt((n-3)/2),s=e[0].getContext("2d");function l(t,e){s.beginPath();s.arc(r,r,o,-Math.PI/2,Math.PI*1.5*e,false);s.strokeStyle=t;s.lineCap="round";s.lineWidth=3;s.stroke()}t.click(function(){$("body, html").animate({scrollTop:0},800)});$(window).scroll(function(){var e=$(document).height()-$(window).height(),r=$(window).scrollTop(),o=parseInt(r/e*100);if(r>=200){t.addClass("display");s.clearRect(0,0,n,a);l("#efefef",1);l("#555555",o/100)}else t.removeClass("display");i.attr("data-percent",o)})});$(function(){var t=$("#toc");if(!visible(t))return;var e=t.children(),i=0;initAndUpdate(function(){i=e.height()});scrollSpy(t,{offset:200});makeSticky(t,{within:".post-body"});$(".toc-item").on("scrollspy",function(){var t=e.scrollTop(),n=$(this).children(".toc-link"),a=n.position().top;if($(this).height()!=n.height())return;if(a<=0)e.scrollTop(t+a);else if(i<=a)e.scrollTop(t+a+n.outerHeight()-i)})});$(function(){if(!$(".footnotes").length)return;$(".footnote-ref").each(function(){var t=$($(this).children("a").attr("href")),e=$("<span>",{"class":"fn-content"}),i=$("<span>",{"class":"fn-text"});t.find(".footnote-backref").remove();$(this).append(e.append(i.html(t.html())))});initAndUpdate(function(){var t=$(".fn-content").removeAttr("style");if($(window).width()<640)t.css("width",$(window).width()/2);else t.css("width",340);t.each(function(){var t=$(this).children(".fn-text").outerWidth();$(this).css({width:t,"margin-left":t/-2})})});var t=$();$("#primary").click(function(e){var i=$(e.target),n=i.closest(".footnote-ref");if(!t.is(n)){t.removeClass("active");n.addClass("active");t=n}else if(i.is("a"))t.toggleClass("active")})});$(function(){var t=$("#archive-nav");if(!visible(t))return;scrollSpy(t,{offset:150});makeSticky(t)});